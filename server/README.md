# ðŸ”§ Chess Server

Linuxì—ì„œ Cë¡œ êµ¬í˜„ëœ ë©€í‹°í”Œë ˆì´ì–´ ì²´ìŠ¤ ê²Œìž„ì˜ ì„œë²„ ì»´í¬ë„ŒíŠ¸ìž…ë‹ˆë‹¤.

## ðŸš€ ë¹Œë“œ ë° ì‹¤í–‰

### ë¹Œë“œ
```bash
# ì„œë²„ë§Œ ë¹Œë“œ
./build.sh server

# ì „ì²´ ë¹Œë“œ
./build.sh
```

### ì‹¤í–‰
```bash
# ê¸°ë³¸ í¬íŠ¸(8080)ë¡œ ì„œë²„ ì‹¤í–‰
./build/server/server

# íŠ¹ì • í¬íŠ¸ë¡œ ì„œë²„ ì‹¤í–‰
./build/server/server --port 9090
```

## ðŸ“‹ ë¡œê·¸ ì‹œìŠ¤í…œ

ì„œë²„ëŠ” ì½˜ì†”ì— ìƒ‰ìƒì´ ìžˆëŠ” ë¡œê·¸ë¥¼ ì§ì ‘ ì¶œë ¥í•©ë‹ˆë‹¤. ë³„ë„ì˜ ë¡œê·¸ íŒŒì¼ì„ ìƒì„±í•˜ì§€ ì•Šìœ¼ë©°, ì‹¤ì‹œê°„ìœ¼ë¡œ ì„œë²„ ìƒíƒœë¥¼ í™•ì¸í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤.

### ë¡œê·¸ ì¶œë ¥ íŠ¹ì§•
- **ì‹¤ì‹œê°„ ì½˜ì†” ì¶œë ¥**: ì„œë²„ ì‹¤í–‰ ì‹œ í„°ë¯¸ë„ì— ë°”ë¡œ í‘œì‹œ
- **ìƒ‰ìƒ êµ¬ë¶„**: ë¡œê·¸ ë ˆë²¨ë³„ë¡œ ë‹¤ë¥¸ ìƒ‰ìƒ ì ìš©
- **ìƒì„¸í•œ ì •ë³´**: íƒ€ìž„ìŠ¤íƒ¬í”„, íŒŒì¼ëª…:ë¼ì¸ë²ˆí˜¸, í•¨ìˆ˜ëª… í¬í•¨

### ë¡œê·¸ ë ˆë²¨
- `DEBUG`: ìƒì„¸í•œ ë””ë²„ê·¸ ì •ë³´ (ë„¤íŠ¸ì›Œí¬ ì´ë²¤íŠ¸, ë©”ì‹œì§€ ì²˜ë¦¬ ë“±)
- `INFO`: ì¼ë°˜ ì •ë³´ ë©”ì‹œì§€ (í´ë¼ì´ì–¸íŠ¸ ì—°ê²°, ê²Œìž„ ì‹œìž‘ ë“±)
- `WARN`: ê²½ê³  ë©”ì‹œì§€ (ë§¤ì¹­ ì‹¤íŒ¨, ìž˜ëª»ëœ ìš”ì²­ ë“±)
- `ERROR`: ì˜¤ë¥˜ ë©”ì‹œì§€ (ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜, ì²˜ë¦¬ ì‹¤íŒ¨ ë“±)
- `FATAL`: ì‹¬ê°í•œ ì˜¤ë¥˜ ë©”ì‹œì§€ (ì„œë²„ ì¢…ë£Œ í•„ìš”í•œ ì˜¤ë¥˜)

### ðŸŽ¨ ìƒ‰ìƒ êµ¬ë¶„

- ðŸ”´ **ë¹¨ê°„ìƒ‰**: ERROR, FATAL ë©”ì‹œì§€
- ðŸŸ¡ **ë…¸ëž€ìƒ‰**: WARN ë©”ì‹œì§€  
- ðŸŸ¢ **ì´ˆë¡ìƒ‰**: INFO ë©”ì‹œì§€
- ðŸ”µ **íŒŒëž€ìƒ‰**: DEBUG ë©”ì‹œì§€
- ðŸ”µ **í•˜ëŠ˜ìƒ‰**: íƒ€ìž„ìŠ¤íƒ¬í”„
- ðŸŸ£ **ìžì£¼ìƒ‰**: íŒŒì¼ëª…:ë¼ì¸ë²ˆí˜¸
- âšª **íšŒìƒ‰**: í•¨ìˆ˜ëª…

### ë¡œê·¸ ì¶œë ¥ ì˜ˆì‹œ

```
[2025-06-03 20:16:58] [INFO] main.c:41 main() - Chess server starting... (PID: 159598)
[2025-06-03 20:16:58] [DEBUG] server_network.c:55 create_and_bind_listener() - Socket created: fd=3
[2025-06-03 20:16:58] [INFO] server_network.c:161 event_loop() - Starting event loop...
[2025-06-03 20:17:20] [INFO] server_network.c:156 handle_new_connection() - New client connected: fd=7
[2025-06-03 20:17:21] [INFO] ping.c:18 handle_ping_message() - Ping received from fd=7: Hello Server!
[2025-06-03 20:17:25] [INFO] match_manager.c:178 add_player_to_matching() - Player Alice(fd=7) added to waiting queue
```

## ðŸ—ï¸ ì•„í‚¤í…ì²˜

### í•µì‹¬ ì»´í¬ë„ŒíŠ¸

1. **server_network.c**: epoll ê¸°ë°˜ ë„¤íŠ¸ì›Œí¬ ì´ë²¤íŠ¸ ì²˜ë¦¬
2. **protocol.c**: protobuf ë©”ì‹œì§€ ì§ë ¬í™”/ì—­ì§ë ¬í™”
3. **match_manager.c**: ë§¤ì¹­ ì‹œìŠ¤í…œ ë° ê²Œìž„ ê´€ë¦¬
4. **handlers/**: ë©”ì‹œì§€ íƒ€ìž…ë³„ ì²˜ë¦¬ í•¸ë“¤ëŸ¬ë“¤
5. **common/logger.c**: ìŠ¤ë ˆë“œ ì•ˆì „ ë¡œê·¸ ì‹œìŠ¤í…œ (ì½˜ì†” ì¶œë ¥)

## ðŸ› ï¸ ê°œë°œìž ê°€ì´ë“œ

### ì‹¤ì‹œê°„ ë¡œê·¸ ëª¨ë‹ˆí„°ë§

ì„œë²„ ì‹¤í–‰ ì‹œ í„°ë¯¸ë„ì—ì„œ ì‹¤ì‹œê°„ìœ¼ë¡œ ë¡œê·¸ë¥¼ í™•ì¸í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤:

```bash
# ì„œë²„ ì‹¤í–‰ - ë¡œê·¸ê°€ ì‹¤ì‹œê°„ìœ¼ë¡œ ì½˜ì†”ì— ì¶œë ¥ë¨
./build/server/server --port 8080
```

### ë””ë²„ê¹… íŒ

1. **ì„œë²„ ì‹œìž‘ ì‹œ ë¡œê·¸ í™•ì¸**:
   ```bash
   # ì„œë²„ ì‹¤í–‰í•˜ë©´ ì´ˆê¸°í™” ê³¼ì •ì´ ë¡œê·¸ë¡œ í‘œì‹œë¨
   ./build/server/server
   ```

2. **ì—°ê²° ë¬¸ì œ ì§„ë‹¨**:
   - í´ë¼ì´ì–¸íŠ¸ ì—°ê²° ì‹œ `New client connected` ë©”ì‹œì§€ í™•ì¸
   - ë„¤íŠ¸ì›Œí¬ ì—ëŸ¬ ì‹œ ë¹¨ê°„ìƒ‰ ERROR ë©”ì‹œì§€ í™•ì¸

3. **ë§¤ì¹­ ì‹œìŠ¤í…œ ë””ë²„ê¹…**:
   - ë§¤ì¹­ ìš”ì²­ ì‹œ `Match request from player` ë©”ì‹œì§€ í™•ì¸
   - ê²Œìž„ ì‹œìž‘ ì‹œ `Match found! Game started` ë©”ì‹œì§€ í™•ì¸

### ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§

```bash
# ë™ì‹œ ì—°ê²° ìˆ˜ í™•ì¸
netstat -an | grep :8080 | grep ESTABLISHED | wc -l

# ì„œë²„ í”„ë¡œì„¸ìŠ¤ ë¦¬ì†ŒìŠ¤ ì‚¬ìš©ëŸ‰
ps aux | grep server
```

## ðŸ› ë¬¸ì œ í•´ê²°

### ì¼ë°˜ì ì¸ ë¬¸ì œë“¤

1. **í¬íŠ¸ ì´ë¯¸ ì‚¬ìš© ì¤‘**:
   ```bash
   # í¬íŠ¸ ì‚¬ìš© í”„ë¡œì„¸ìŠ¤ í™•ì¸
   lsof -i :8080
   
   # ë‹¤ë¥¸ í¬íŠ¸ë¡œ ì‹¤í–‰
   ./build/server/server --port 9090
   ```

2. **ë©”ëª¨ë¦¬ ëˆ„ìˆ˜ ë””ë²„ê¹…**:
   ```bash
   # valgrindë¡œ ë©”ëª¨ë¦¬ ê²€ì‚¬
   valgrind --leak-check=full ./build/server/server
   ```

### ë¡œê·¸ë¥¼ í†µí•œ ë¬¸ì œ ì§„ë‹¨

ì„œë²„ ì‹¤í–‰ ì¤‘ í„°ë¯¸ë„ì—ì„œ ë‹¤ìŒ í•­ëª©ë“¤ì„ í™•ì¸í•˜ì„¸ìš”:

- **ì´ˆê¸°í™” ê³¼ì •**: ì„œë²„ ì‹œìž‘ ì‹œ ë‚˜íƒ€ë‚˜ëŠ” INFO ë©”ì‹œì§€ë“¤
- **í´ë¼ì´ì–¸íŠ¸ ì—°ê²°**: `New client connected` ë©”ì‹œì§€
- **ë§¤ì¹­ ì‹œìŠ¤í…œ**: ë§¤ì¹­ ìš”ì²­ê³¼ ê²Œìž„ ìƒì„± ê´€ë ¨ ë©”ì‹œì§€
- **ì—ëŸ¬ ë©”ì‹œì§€**: ë¹¨ê°„ìƒ‰ìœ¼ë¡œ í‘œì‹œë˜ëŠ” ERROR/FATAL ë©”ì‹œì§€

### ë¡œê·¸ ì¶œë ¥ ë¦¬ë‹¤ì´ë ‰ì…˜

í•„ìš”í•œ ê²½ìš° ë¡œê·¸ë¥¼ íŒŒì¼ë¡œ ì €ìž¥í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤:

```bash
# ëª¨ë“  ì¶œë ¥ì„ íŒŒì¼ë¡œ ì €ìž¥
./build/server/server 2>&1 | tee server_output.log

# ì—ëŸ¬ë§Œ íŒŒì¼ë¡œ ì €ìž¥
./build/server/server 2> server_errors.log
``` 